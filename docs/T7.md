
# T7 â€” Email Subscriptions & Notifications

**Goal:**  
Allow users to subscribe to idea updates by topic and receive email digests.

---

## ğŸ€ Deliverables
- Table `subscriptions` (already in DB from T5)
- API routes for managing subscriptions
- Integration with email service (Resend, SendGrid, Mailgun, etc.)
- Basic email template for new ideas

---

## ğŸ›  Steps
1. **Set up Email Provider (Resend recommended):**
   - Get API key and add to `.env.local` as `RESEND_API_KEY`
   - Install SDK: `npm i resend`
2. **API routes:**
   - `/api/subscriptions` â†’ create/update user subscription
   - `/api/notifications/send-digest` â†’ send batch emails by topic
3. **Email template example:**
   ```ts
   const html = `
     <h2>Fresh ideas from Pain2Gain</h2>
     <ul>
       ${ideas.map(i => `<li><b>${i.title}</b> â€” ${i.elevatorPitch}</li>`).join('')}
     </ul>
     <p><a href="${BASE_URL}/unsubscribe?token=${token}">Unsubscribe</a></p>
   `;
   ```
4. **Digest logic:**
   - Select ideas created in the last 24h.
   - Group by topic.
   - Send one email per subscriber.
5. **(Optional)** Add manual trigger `/api/notifications/test` for testing.

---

## ğŸ’¡ Notes
- Real email sending not required; just ensure integration code is valid.
- Use environment variables for keys, never hardcode them.
